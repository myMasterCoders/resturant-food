import{s as y}from"./BV26Eilu.js";import{u as h,r as i,M as C,N as S,o as n,c as a,v as u,a as t,d as f,B as v,t as b,a0 as V,F as g,x as k,$,y as w,z as O,A as T,b as j,D as N}from"./CEHpqohg.js";const B={class:"flex flex-row items-center justify-end"},E={key:0},L={key:0,class:"inline-block h-5 w-5 mx-2 animate-spin rounded-full border-4 border-solid border-current border-e-transparent align-[-0.125em] text-surface motion-reduce:animate-[spin_1.5s_linear_infinite] dark:text-white",role:"status"},M={key:1},R=t("span",null,"00",-1),U=t("span",null,":",-1),D={__name:"ResendOtp",emits:["resendError"],setup(x,{emit:p}){const l=h(),r=i(!1),c=p,e=i(10),_=i(!1);let d;async function s(){try{r.value=!0;const o=await $fetch("/api/auth/resend",{method:"POST",headers:{"Content-Type":"application/json"}});l.success("کد تایید دوباره ارسال شد",{position:"top-right",timeout:3e3,rtl:!0}),_.value=!1,e.value=10,d=y(m,1e3),console.log(o)}catch(o){c("resendError",Object.values(o.data.data.message).flat())}finally{r.value=!1}}const m=()=>{e.value>0&&e.value--,e.value<10&&(e.value="0"+e.value),e.value<=0&&(e.value="00",_.value=!0,clearInterval(d))};return C(()=>{d=y(m,1e3)}),S(()=>{clearInterval(d)}),(o,it)=>(n(),a("div",B,[u(_)?(n(),a("div",E,[t("button",{onClick:s,type:"button",class:"bg-sky-600 px-4 py-2 rounded-xl text-slate-100 text-[13px] mx-4"},[f(" ارسال دوباره کد تایید "),u(r)?(n(),a("div",L)):v("",!0)])])):(n(),a("div",M,[R,U,t("span",null,b(u(e)),1)]))]))}},I={class:"check-otp"},P={class:"container mx-auto p-1"},F={class:"w-full h-auto"},z={class:"w-4/12 mx-auto"},A={class:"flex flex-col"},q=t("label",null,"کد تایید را وارد کنید:",-1),G=t("br",null,null,-1),H=t("br",null,null,-1),J={type:"submit",class:"bg-sky-600 rounded-xl px-8 py-2 text-slate-100 text-[15px]"},K={key:0,class:"inline-block h-5 w-5 mx-2 animate-spin rounded-full border-4 border-solid border-current border-e-transparent align-[-0.125em] text-surface motion-reduce:animate-[spin_1.5s_linear_infinite] dark:text-white",role:"status"},Q={__name:"CheckOtp",setup(x){const{user:p}=V(),l=h(),r=i([]),c=i(!1),e=i("");async function _(){if(e.value===""){l.error("کد تایید را وارد کنید",{position:"top-right",timeout:3e3,rtl:!0});return}if(!/^[0-9]{6}$/ig.test(e.value)){l.error("فیلد ورودی نامعتبر است",{position:"top-right",timeout:3e3,rtl:!0});return}try{c.value=!0;const s=await $fetch("/api/auth/otp",{method:"POST",body:{otp:e.value},headers:{"Content-Type":"application/json"}});return l.success("به پنل کاربری وارد شدید",{position:"top-right",timeout:3e3,rtl:!0}),p.value=s,N("/")}catch(s){r.value=Object.values(s.data.data.message).flat()}finally{c.value=!1}}return(d,s)=>{const m=D;return n(),a("section",I,[t("div",P,[t("div",F,[(n(!0),a(g,null,k(u(r),o=>(n(),a("div",{class:"bg-red-600 text-slate-100",key:o.id},[t("p",null,b(o),1)]))),128)),t("div",z,[t("div",A,[t("form",{onSubmit:$(_,["prevent"])},[q,G,w(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=o=>T(e)?e.value=o:null),class:"p-2 w-full my-4 border border-1 border-slate-200 outline-none",placeholder:"کد تایید"},null,512),[[O,u(e)]]),H,t("button",J,[f(" کد تایید "),u(c)?(n(),a("div",K)):v("",!0)])],32),j(m,{onResendError:s[1]||(s[1]=o=>r.value=o),class:"my-4"})])])])])])}}},W={class:"login"},X={class:"container mx-auto p-1"},Y={class:"w-full h-auto"},Z={key:0},tt={key:1},et={class:"w-4/12 mx-auto"},st={class:"flex flex-col"},ot=t("label",{class:"my-2"},"شماره موبایل خود را وارد کنید:",-1),nt=t("br",null,null,-1),at=t("br",null,null,-1),lt={type:"submit",class:"my-4 bg-sky-600 px-8 py-2 rounded-xl text-slate-100 text-[15px]"},rt={key:0,class:"inline-block h-5 w-5 mx-2 animate-spin rounded-full border-4 border-solid border-current border-e-transparent align-[-0.125em] text-surface motion-reduce:animate-[spin_1.5s_linear_infinite] dark:text-white",role:"status"},dt={__name:"Login",setup(x){const p=h(),l=i(""),r=i([]),c=i(!1),e=i(!1);async function _(){if(l.value===""){p.error("فیلد روردی الزامی است",{position:"top-right",timeout:3e3,rtl:!0});return}if(!/^(\+98|0)?9\d{9}$/ig.test(l.value)){p.error("شماره موبایل صحیح نیست",{position:"top-right",timeout:3e3,rtl:!0});return}try{c.value=!0;const s=await $fetch("/api/auth/login",{method:"POST",body:{cellphone:l.value},headers:{"Content-Type":"application/json"}});p.success("کد تایید با موفقیت ارسال شد",{position:"top-right",timeout:3e3,rtl:!0}),console.log(s),e.value=!0}catch(s){r.value=Object.values(s.data.data.message).flat()}finally{c.value=!1}}return(d,s)=>{const m=Q;return n(),a("section",W,[t("div",X,[t("div",Y,[u(e)?(n(),a("div",Z,[j(m)])):(n(),a("div",tt,[t("div",et,[t("div",st,[(n(!0),a(g,null,k(u(r),o=>(n(),a("div",{key:o.id,class:"bg-red-600 text-slate-100"},[t("p",null,b(o),1)]))),128)),t("form",{onSubmit:$(_,["prevent"])},[ot,nt,w(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=o=>T(l)?l.value=o:null),class:"my-4 w-full p-2 outline-none border border-1 border-slate-200",placeholder:"شماره موبایل"},null,512),[[O,u(l)]]),at,t("button",lt,[f(" ارسال "),u(c)?(n(),a("div",rt)):v("",!0)])],32)])])]))])])])}}};export{dt as default};
