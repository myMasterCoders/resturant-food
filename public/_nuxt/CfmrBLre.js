import{_ as D}from"./BGd5ulo-.js";import{n as O,u as L,r as m,q as C,s as R,o as n,c as a,v as o,F as f,a as e,x as j,t as l,y as U,z,A as E,d as v,B as q,b as N,w as T,C as H,D as I}from"./CEHpqohg.js";import{u as M}from"./CER20gh2.js";import{n as r}from"./DK30iesx.js";import{u as G}from"./CNCUaJ12.js";const J=O("/image/empty.png"),K={class:"cart"},Q=H('<div class="flex flex-row items-center w-full justify-around"><div class="w-2/12 text-center">محصول</div><div class="w-2/12 text-center">نام محصول</div><div class="w-2/12 text-center">قیمت</div><div class="w-2/12 text-center">تعداد</div><div class="w-2/12 text-center">قیمت کل</div><div class="w-2/12 text-center">حذف</div></div>',1),W={class:"flex flex-col my-8"},X={class:"w-2/12 text-center"},Y=["src"],Z={class:"w-2/12 text-center"},ee={class:"w-2/12 text-center"},te={key:0},se={class:"text-slate-600 my-4"},oe={class:"my-2"},ne={key:1},ae={class:"my-2"},le={class:"w-2/12 text-center flex flex-row items-center justify-around"},ie=["onClick"],re=["onClick"],ce={class:"w-2/12 text-center"},de={key:0},ue={key:1},me={class:"w-2/12 text-center"},_e=["onClick"],pe={class:"w-full flex flex-row items-center justify-around my-4"},xe={class:"w-4/12 flex flex-row items-center"},he={key:0,class:"inline-block h-5 w-5 mx-2 animate-spin rounded-full border-4 border-solid border-current border-e-transparent align-[-0.125em] text-surface motion-reduce:animate-[spin_1.5s_linear_infinite] dark:text-white",role:"status"},ye={class:"w-4/12 flex flex-row items-center justify-around"},fe=e("p",null,"انتخاب ادرس:",-1),ve={key:0},be=["value"],we={key:1},ge=e("button",{type:"button",class:"bg-sky-600 px-2 py-2 rounded-xl text-white text-[13px]"},"ایجاد ادرس",-1),ke={class:"my-4 w-4/12 mx-auto flex flex-col"},Fe=e("h2",null,"مجموع کل سبد خرید:",-1),Ce={class:"flex flex-row items-center justify-between my-2"},je=e("p",null,"مبلغ کل پرداختی",-1),qe={class:"text-slate-600"},Ne={class:"flex flex-row items-center justify-between my-2"},Te={class:"mx-2 text-green-600"},Se={class:"text-slate-600"},Ve={class:"flex flex-row items-center justify-between my-2"},Pe=e("p",null,"مبلغ قابل پرداخت:",-1),Ae={class:"text-slate-600"},$e={class:"w-3/12 mx-auto my-4"},Be={key:0,class:"inline-block h-5 w-5 mx-2 animate-spin rounded-full border-4 border-solid border-current border-e-transparent align-[-0.125em] text-surface motion-reduce:animate-[spin_1.5s_linear_infinite] dark:text-white",role:"status"},De={key:1,class:"w-4/12 mx-auto"},Oe=e("img",{src:J,alt:"",class:"w-full h-[300px]"},null,-1),Le=e("p",{class:"text-center my-4"},"سبد خرید خالی است",-1),Re={class:"w-4/12 mx-auto"},Ue=e("button",{type:"button",class:"bg-[#ff00a6] my-4 text-center text-[13px] text-slate-100 px-4 py-1 rounded-lg"},"مشاهده محصولات",-1),Ke={__name:"cart",async setup(ze){let _,b;const c=L(),d=m(!1),S=m([]),u=G(),i=m(""),p=m(null),x=C(()=>u.allProducts);console.log("products",x.value);const h=C(()=>u.allAmount),y=m(0);m(null);function V(t){u.deleteProduct(t)}function P(){u.clear()}async function A(){if(i.value===""||i.value===null){c.error("کد تخفیف الزامی است",{position:"top-right",timeout:3e3,rtl:!0});return}if(isNaN(i.value)){c.error("فیلد ورودی نامعتبر است",{position:"top-right",timeout:3e3,rtl:!0});return}try{d.value=!0;const t=await $fetch("/api/cart/checkCoupon",{method:"POST",headers:{"Content-Type":"application/json"},body:{code:i.value}});c.success("کد تخفیف را وارد کردید",{position:"top-right",timeout:3e3,rtl:!0}),y.value=t.percentage,console.log(t)}catch(t){c.error(Object.values(t.data.data.message).flat().toString())}finally{d.value=!1}}const{data:w}=([_,b]=R(()=>M("/api/cart/address",{headers:{"Content-Type":"application/json"}},"$0qHVSrtFrD")),_=await _,b(),_);function $(t){p.value=t.target.value}async function B(){if(p.value===""||p.value===null){c.error("فیلد  ادرس  الزامی است",{position:"top-right",timeout:3e3,rtl:!0});return}try{d.value=!0;const t=await $fetch("/api/payment/send",{method:"POST",body:{cart:x.value,coupon:i.value,address_id:p.value}});c.success("در حال انتقال به سایت پذیرنده",{position:"top-right",timeout:3e3,rtl:!0}),await I(t.url,{external:!0}),console.log("data",t)}catch(t){S.value=Object.values(t.data.message).flat()}finally{d.value=!1}}return(t,g)=>{var F;const k=D;return n(),a("section",K,[o(x).length>0?(n(),a(f,{key:0},[Q,e("div",W,[(n(!0),a(f,null,j(o(x),s=>(n(),a("div",{key:s.id,class:"flex flex-row justify-around items-center w-full my-2"},[e("div",X,[e("img",{src:`${s.primary_image}`,alt:"",class:"w-[120px] h-[120px] items-center mx-auto rounded-xl"},null,8,Y)]),e("div",Z,[e("p",null,l(s.name),1)]),e("div",ee,[s.is_sale?(n(),a("div",te,[e("del",se,l(("numberFormat"in t?t.numberFormat:o(r))(s.price))+" تومان",1),e("p",oe,l(("numberFormat"in t?t.numberFormat:o(r))(s.sale_price))+" تومان",1)])):(n(),a("div",ne,[e("p",ae,l(("numberFormat"in t?t.numberFormat:o(r))(s.price))+" تومان",1)]))]),e("div",le,[e("button",{onClick:()=>s.qty<s.quantity&&o(u).increment(s.id),type:"button",class:"bg-green-600 mx-4 p-2 rounded-lg text-slate-100"},"+",8,ie),e("span",null,l(s.qty),1),e("button",{onClick:()=>s.qty>1&&o(u).decrement(s.id),type:"button",class:"bg-red-600 mx-4 p-2 rounded-lg text-slate-100"},"-",8,re)]),e("div",ce,[s.is_sale?(n(),a("div",de,[e("p",null,l(("numberFormat"in t?t.numberFormat:o(r))(s.qty*s.sale_price))+" تومان",1)])):(n(),a("div",ue,[e("p",null,l(("numberFormat"in t?t.numberFormat:o(r))(s.qty*s.price))+" تومان",1)]))]),e("div",me,[e("button",{onClick:Ee=>V(s.id),type:"button",class:"bg-red-600 p-2 text-slate-100"},"حذف",8,_e)])]))),128))]),e("div",{class:"mt-4"},[e("button",{onClick:P,type:"button",class:"bg-sky-600 px-4 py-2 text-slate-100 rounded-xl text-[13px] mx-4"},"پاک کردن کل سبد خرید")]),e("div",pe,[e("div",xe,[U(e("input",{"onUpdate:modelValue":g[0]||(g[0]=s=>E(i)?i.value=s:null),type:"text",class:"p-2 w-10/12 outline-none border border-1 border-slate-200 rounded-xl text-slate-600",placeholder:"کد تخفیف"},null,512),[[z,o(i)]]),e("button",{onClick:A,type:"button",class:"bg-sky-600 px-1 py-1 rounded-lg text-[12px] text-white"},[v(" اعمال کد تخفیف "),o(d)?(n(),a("div",he)):q("",!0)])]),e("div",ye,[fe,((F=o(w))==null?void 0:F.length)!==0?(n(),a("div",ve,[e("select",{onChange:$,class:"p-2"},[(n(!0),a(f,null,j(o(w),s=>(n(),a("option",{key:s.id,value:s.id},l(s.title),9,be))),128))],32)])):(n(),a("div",we,[N(k,{to:"/profile"},{default:T(()=>[ge]),_:1})]))])]),e("div",ke,[Fe,e("div",Ce,[je,e("span",qe,l(("numberFormat"in t?t.numberFormat:o(r))(o(h)))+" تومان",1)]),e("div",Ne,[e("p",null,[v(" تخفیف:"),e("span",Te,l(o(y))+" %",1)]),e("span",Se,l(("numberFormat"in t?t.numberFormat:o(r))(o(h)*o(y)/100))+" تومان",1)]),e("div",Ve,[Pe,e("span",Ae,l(("numberFormat"in t?t.numberFormat:o(r))(o(h)-o(h)*o(y)/100))+" تومان",1)])]),e("div",$e,[e("button",{onClick:B,type:"button",class:"bg-green-600 px-8 py-2 rounded-xl text-slate-100"},[v(" پرداخت "),o(d)?(n(),a("div",Be)):q("",!0)])])],64)):(n(),a("div",De,[Oe,Le,e("div",Re,[N(k,{to:"/menu"},{default:T(()=>[Ue]),_:1})])]))])}}};export{Ke as default};
